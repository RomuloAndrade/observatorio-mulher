)
cvli_base_
View(cvli_base_)
saveRDS(cvli_base_,'Dados/cvli_base.rds')
runApp()
df_cvli_idade
df_cvli_idade <- readRDS('Dados/df_cvli_idade.rds')
df_cvli_idade
df_cvli_idade <- df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
)) |>
group_by(grupo_de_idade,Gênero   ) |># ,Gênero
summarise(Qtd = n())  |>
filter(!is.na(grupo_de_idade) ) |>
ungroup() |>
group_by(Gênero) |>
filter(Gênero!='Não Informado') |>
mutate(Perc= Qtd/sum(Qtd))
df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
)) |>
group_by(grupo_de_idade,Gênero   )
library(dplyr)
df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
)) |>
group_by(grupo_de_idade,Gênero   ) |># ,Gênero
summarise(Qtd = n())
df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
),
Ano=lubridate::year(Data)
) |>
group_by(grupo_de_idade,Gênero,Ano   ) |># ,Gênero
summarise(Qtd = n())
df_cvli_idade <- df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
),
Ano=lubridate::year(Data)
) |>
group_by(grupo_de_idade,Gênero,Ano   ) |># ,Gênero
summarise(Qtd = n())  |>
filter(!is.na(grupo_de_idade) ) |>
ungroup() |>
group_by(Gênero) |>
filter(Gênero!='Não Informado') |>
mutate(Perc= Qtd/sum(Qtd))
df_cvli_idade
df_cvli_idade <- df_cvli |>
rename(idade=`Idade da Vítima`) |>
mutate( idade =as.numeric(idade),
grupo_de_idade = case_when(
idade <10 ~ '0 a 10 anos',
idade <=17 ~ '11 a 17 anos',
idade <=23 ~ '18 a 23 anos',
idade <=29 ~ '24 a 29 anos',
idade <=39 ~ '30 a 39 anos',
idade <=49 ~ '40 a 49 anos',
idade <=59 ~ '50 a 59 anos',
idade >=60 ~ 'Mais de 60'
),
Ano=lubridate::year(Data)
) |>
group_by(grupo_de_idade,Gênero,Ano   ) |># ,Gênero
summarise(Qtd = n())  |>
filter(!is.na(grupo_de_idade) ) |>
ungroup() |>
group_by(Gênero,Ano) |>
filter(Gênero!='Não Informado') |>
mutate(Perc= Qtd/sum(Qtd))
df_cvli_idade
saveRDS(df_cvli_idade,'Dados/df_cvli_idade.rds')
runApp()
df_cvli |>
filter(Gênero != 'Não Informado', Ano == input$select_ano_viol) |>
group_by(Semana,Gênero) |>  #
summarise(Qtd. = n()) |>
group_by(Gênero) |>
mutate(Perc. = Qtd./sum(Qtd.))
df_cvli |>
filter(Gênero != 'Não Informado', Ano =='2024') |> # input$select_ano_viol) |>
group_by(Semana,Gênero) |>  #
summarise(Qtd. = n()) |>
group_by(Gênero) |>
mutate(Perc. = Qtd./sum(Qtd.)) |>
pivot_wider(
names_from = Gênero,
values_from = c(Perc.,Qtd.))
df_cvli
df_cvli <- readRDS('Dados/cvli_base.rds')
df_cvli
df_cvli |>
filter(Gênero != 'Não Informado', Ano =='2024') |> # input$select_ano_viol) |>
group_by(Semana,Gênero) |>  #
summarise(Qtd. = n()) |>
group_by(Gênero) |>
mutate(Perc. = Qtd./sum(Qtd.)) |>
pivot_wider(
names_from = Gênero,
values_from = c(Perc.,Qtd.))
temp <-   df_cvli |>
filter(Gênero != 'Não Informado', Ano =='2024') |> # input$select_ano_viol) |>
group_by(Semana,Gênero) |>  #
summarise(Qtd. = n()) |>
group_by(Gênero) |>
mutate(Perc. = Qtd./sum(Qtd.)) |>
pivot_wider(
names_from = Gênero,
values_from = c(Perc.,Qtd.))
maximo <- max( Perc._Feminino, Perc._Masculino)
maximo
maximo <- max( temp$Perc._Feminino, temp$Perc._Masculino)
maximo
runApp()
?e_tooltip
runApp()
runApp()
df_renda <- readRDS('Dados/df_renda_.rds')
View(df_renda)
df_renda
df_renda
runApp()
saveRDS(df_renda,'Dados/df_renda_.rds')
Tipos_trab23 <- readRDS('Dados/Tipos_trab_2023.rds')
runApp()
df_renda <- readxl::read_xlsx('Dados/renda.xlsx')
df_renda
saveRDS(df_renda,'Dados/df_renda_.rds')
df_renda <- readRDS('Dados/df_renda_.rds') # todas as fontes habitual real
df_renda
runApp()
df_renda
?e_axis_formatter
runApp()
runApp()
runApp()
runApp()
df_desemp <- readxl::read_xlsx('Dados/Desocupação.xlsx')
saveRDS(df_desemp,'Dados/df_desemp.rds')
runApp()
df_desemp
runApp()
output$taxa_desemp_fort <-   renderEcharts4r({
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR"),style = "percent"
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="%",formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
#
#
# e_charts(data = df_desemp[df_desemp$V2007=='Homem',], x=Ano) |> # HOMEM
#   e_legend(selected=list('Geral'=F), bottom= 0,right= 0) |>
#   e_line(Tx_desocupacao ,smooth=T, color='#2ec7c9',legend =F,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#2ec7c9',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Homem' }")))  |>
#   e_y_axis(show=F,formatter = e_axis_formatter("percent", digits = 0))  |>
#   e_data(data=df_desemp[df_desemp$V2007=='Mulher',] , x= Ano    ) |>  #MULHER
#   e_line(Tx_desocupacao ,smooth=T,color='#b6a2de',legend =F,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#b6a2de',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Mulher' }"))) |>
#   e_data(data=df_desemp[df_desemp$V2007=='Geral',] , x= Ano    ) |>  #GERAL
#   e_line(Tx_desocupacao ,smooth=T,color='#008acd', legend = T,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#008acd',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Geral' }"))) |>
#   e_tooltip(trigger="item", formatter =
#               htmlwidgets::JS(
#                 "function(p) {
#           v = Intl.NumberFormat('pt-BR', { style: 'decimal'}).format(p.value[1]);
#           return('<strong>' + p.seriesName + '</strong>' +
#           '<br>Taxa de desemprego: ' + Intl.NumberFormat('pt-BR', { style: 'decimal',minimumFractionDigits: 2,
#   maximumFractionDigits: 2}).format(p.value[1]*100) + '%'+
#           '<br>Ano: ' +p.value[0]  );
#           }"), textStyle=list(fontFamily="arial", fontSize=13)) |>
#     e_grid(top='2%')
#
})
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR"),style = "percent"
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="%",formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
df_desemp <- readxl::read_xlsx('Dados/Desocupação.xlsx')
df_desemp
df_desemp <- readxl::read_xlsx('Dados/Desocupação.xlsx') |>
mutate(`Taxa de Desocupação`=`Taxa de Desocupação`/100)
box::use(
shiny[...],
bs4Dash[...],
forcats[fct_reorder],
echarts4r[e_theme_register,
renderEcharts4r,
e_axis_formatter,
e_tooltip_pointer_formatter,
e_tooltip_choro_formatter,
e_title,
e_radar,
e_radar_opts,
e_data,
e_tooltip_item_formatter,
e_bar,
e_line,
e_effect_scatter,
e_toolbox_feature,
e_legend,
e_theme,
e_grid,
e_x_axis,
e_y_axis,
e_flip_coords,
e_charts,
e_color,
e_tooltip,
e_pie,
e_group,
e_connect_group,
e_toolbox,
e_labels,
e_chart],
waiter[...],
sf[st_drop_geometry,
#sf_use_s2,
#st_read,
],
tidyr[pivot_wider,pivot_longer],
dplyr[#left_join,
#right_join,
#bind_rows,
#  arrange,
n,
ungroup,
mutate,
#rename,
select,
filter,
summarise,
group_by],
# readr[read_csv2,read_csv],
leaflet[leaflet,
leafletOptions,
renderLeaflet,
addProviderTiles,
providers,
addPolygons,
addLegend,
hideGroup,
labelOptions,
addScaleBar,
setView,
clearControls,
clearGroup,
addLabelOnlyMarkers,
addMeasure,
removeMeasure,
scaleBarOptions,
highlightOptions,
addLayersControl,
colorNumeric,
colorBin,
labelFormat,
leafletProxy,
colorFactor],
leaflet.extras[addFullscreenControl,
setMapWidgetStyle],
leafpop[popupTable],
reactable[reactable,
colDef,
renderReactable],
htmltools[div],
mapmisc[colourScale],
writexl[write_xlsx],
D3plusR[d3plus,
d3plusSize,
d3plusUi,
d3plusColor,
d3plusDepth,
d3plusLabels,
d3plusTitle,
renderD3plus],
datamods[select_group_server]
)
df_desemp <- readxl::read_xlsx('Dados/Desocupação.xlsx') |>
mutate(`Taxa de Desocupação`=`Taxa de Desocupação`/100)
saveRDS(df_desemp,'Dados/df_desemp.rds')
shiny::runApp()
output$taxa_desemp_fort <-   renderEcharts4r({
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR"),style = c("percent")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
#
#
# e_charts(data = df_desemp[df_desemp$V2007=='Homem',], x=Ano) |> # HOMEM
#   e_legend(selected=list('Geral'=F), bottom= 0,right= 0) |>
#   e_line(Tx_desocupacao ,smooth=T, color='#2ec7c9',legend =F,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#2ec7c9',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Homem' }")))  |>
#   e_y_axis(show=F,formatter = e_axis_formatter("percent", digits = 0))  |>
#   e_data(data=df_desemp[df_desemp$V2007=='Mulher',] , x= Ano    ) |>  #MULHER
#   e_line(Tx_desocupacao ,smooth=T,color='#b6a2de',legend =F,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#b6a2de',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Mulher' }"))) |>
#   e_data(data=df_desemp[df_desemp$V2007=='Geral',] , x= Ano    ) |>  #GERAL
#   e_line(Tx_desocupacao ,smooth=T,color='#008acd', legend = T,symbolSize= 10,
#          emphasis=list( focus= 'series' ),
#          endLabel=list( show=T, color='#008acd',fontWeight= "bold" ,fontSize =10,
#                         formatter= htmlwidgets::JS(" function (params) { return 'Geral' }"))) |>
#   e_tooltip(trigger="item", formatter =
#               htmlwidgets::JS(
#                 "function(p) {
#           v = Intl.NumberFormat('pt-BR', { style: 'decimal'}).format(p.value[1]);
#           return('<strong>' + p.seriesName + '</strong>' +
#           '<br>Taxa de desemprego: ' + Intl.NumberFormat('pt-BR', { style: 'decimal',minimumFractionDigits: 2,
#   maximumFractionDigits: 2}).format(p.value[1]*100) + '%'+
#           '<br>Ano: ' +p.value[0]  );
#           }"), textStyle=list(fontFamily="arial", fontSize=13)) |>
#     e_grid(top='2%')
#
})
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR"),style = c("percent")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
#
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Desocupação`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR",style = c("percent")
)) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
runApp()
df_inf <- readxl::read_xlsx('Dados/Informalidade.xlsx')
df_inf
df_inf <- readxl::read_xlsx('Dados/Informalidade.xlsx') |>
mutate(`Taxa de Desocupação`=`Taxa de Desocupação`/100)
df_inf <- readxl::read_xlsx('Dados/Informalidade.xlsx') |>
mutate(`Taxa de Informalidade`=`Taxa de Informalidade`/100)
saveRDS(df_inf,'Dados/df_inf.rds')
e_charts(data = df_desemp |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Informalidade`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR",style = c("percent"),digits = 1,
)) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
e_charts(data = df_inf |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(`Taxa de Informalidade`,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR",style = c("percent"),digits = 1,
)) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(formatter=e_axis_formatter(style = c("percent"),
locale = 'PT-BR') )
df_inf <- readxl::read_xlsx('Dados/Informalidade.xlsx') |>
mutate(`Taxa de Informalidade`=`Taxa de Informalidade`/100)
saveRDS(df_inf,'Dados/df_inf.rds')
runApp()
df_ocup <- readxl::read_xlsx('Dados/ocupação.xlsx')
df_ocup
df_ocup <- readxl::read_xlsx('Dados/ocupação.xlsx')
saveRDS(df_ocup,'Dados/df_ocup.rds')
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="Qtd.",formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0,min=500) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="Qtd.",formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="Qtd.",min=500,formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#b6a2de','#2ec7c9','#008acd')) |>
e_y_axis(name="Qtd.",min=500,formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="Qtd.",min=500,formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
df_ocup <- readxl::read_xlsx('Dados/ocupação.xlsx')
saveRDS(df_ocup,'Dados/df_ocup.rds')
e_charts(data = df_ocup |> group_by(V2007), x=Ano) |>
e_legend(selected=list('Geral'=F),right= 0,top= "3%") |>
e_line(Ocupação,symbolSize=0) |>
e_tooltip(trigger = c("axis"),
e_tooltip_pointer_formatter(locale = "PT-BR")
) |>
e_color(c('#008acd','#2ec7c9','#b6a2de')) |>
e_y_axis(name="Qtd.",min=500,formatter=e_axis_formatter(style = c("decimal"),
locale = 'PT-BR') )
runApp()
runApp()
runApp()
renv::init()
runApp()
renv::init()
renv::status()
shiny::runApp()
